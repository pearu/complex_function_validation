
   +infj  M~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~M
    maxj  M====================1c=c===cc=c==cc=c=======c=cc==c=ccc==c=c1====================M
  3e292j  M====================2ccccccccccccccccccccccccccccccccccccccc2====================M
  5e276j  M====================1=c======cc===cc=c====cc=c=ccc=====c==cc1====================M
  8e260j  M====================1ccccccccccccccccccccccccccccccccccccccc1====================M
  1e245j  M====================2=======c===============================2====================M
  2e229j  M====================4c==c===c==c==c===c===c=c===c=====c=c==c4====================M
  3e213j  M====================2c===c===cc======ccc=cc=c=cc===ccc===c=c2====================M
  5e197j  M====================1ccccccccccccccccccccccccccccccccccccccc1====================M
  8e181j  M====================2ccccccccccccccccccccccccccccccccccccccc2====================M
  1e166j  M====================2ccccccccccccccccccccccccccccccccccccccc2====================M
  2e150j  M====================2=====c=c=c==c=========c==c==c======c===2====================M
  3e134j  M====================4==c=c===c====c==c==============c===ccc=4====================M
  6e118j  M====================1=========c=c==c=========c=ccc==========1====================M
  9e102j  M====================2ccc=ccc====cccccccc=ccc=ccccc=cc==c=cc=2====================M
   1e87j  M====================3ccccccccccccccccccccccccccccccccccccccc3====================M
   2e71j  M====================3ccccccccccccccccccccccccccccccccccccccc3====================M
   4e55j  M====================2c=========c==================c=cc======2====================M
   6e39j  M====================2=ccc=cc=cccccccc=cc=c=c=cc==c=cccc==c==2====================M
   1e24j  M====================2=c=c====c======cc======c==c=====c====cc2====================M
    2e8j  M====================3c=cc=ccc=ccccc=cc=====c===c=cc=c===c===3====================M
   3e-8j  M====================1ccccccccccccccccccccccccccccccccccccccc1====================M
  4e-24j  M====================1=======================================1====================M
  7e-40j  M====================1=======================================1====================M
  1e-55j  M====================1=======================================1====================M
  2e-71j  M====================1=======================================1====================M
  3e-87j  M====================1=======================================1====================M
 4e-103j  M====================1=======================================1====================M
 7e-119j  M====================1=======================================1====================M
 1e-134j  M====================1=======================================1====================M
 2e-150j  M====================1=======================================1====================M
 3e-166j  M====================1=======================================1====================M
 5e-182j  M====================1=======================================1====================M
 8e-198j  M====================1=======================================1====================M
 1e-213j  M====================1=======================================1====================M
 2e-229j  M====================1=======================================1====================M
 3e-245j  M====================1=======================================1====================M
 5e-261j  M====================1=======================================1====================M
 9e-277j  M====================1=======================================1====================M
 1e-292j  M====================1=======================================1====================M
   tinyj  M====================1=======================================1====================M
      0j  =====================1=======================================1=====================
  -tinyj  M====================1=======================================1====================M
-1e-292j  M====================1=======================================1====================M
-9e-277j  M====================1=======================================1====================M
-5e-261j  M====================1=======================================1====================M
-3e-245j  M====================1=======================================1====================M
-2e-229j  M====================1=======================================1====================M
-1e-213j  M====================1=======================================1====================M
-8e-198j  M====================1=======================================1====================M
-5e-182j  M====================1=======================================1====================M
-3e-166j  M====================1=======================================1====================M
-2e-150j  M====================1=======================================1====================M
-1e-134j  M====================1=======================================1====================M
-7e-119j  M====================1=======================================1====================M
-4e-103j  M====================1=======================================1====================M
 -3e-87j  M====================1=======================================1====================M
 -2e-71j  M====================1=======================================1====================M
 -1e-55j  M====================1=======================================1====================M
 -7e-40j  M====================1=======================================1====================M
 -4e-24j  M====================1=======================================1====================M
  -3e-8j  M====================1ccccccccccccccccccccccccccccccccccccccc1====================M
   -2e8j  M====================3ccccccccccccccccccccccccccccccccccccccc3====================M
  -1e24j  M====================3====c====c========c=c======c==c========3====================M
  -6e39j  M====================2ccccccccccccccccccc=ccccccccccccccccccc2====================M
  -4e55j  M====================2c=cc=====c=====c======cc=c=c==cc=cc===c2====================M
  -2e71j  M====================2ccccccccccccccccccccccccccccccccccccccc2====================M
  -1e87j  M====================1======c=====c========c=c===cc=c===c=c=c1====================M
 -9e102j  M====================2=======================================2====================M
 -6e118j  M====================2====c========c===c=============c====c==2====================M
 -3e134j  M====================3=cccccccccccccccccc=ccccccccccccccccccc3====================M
 -2e150j  M====================1c===cc==cc=ccc==cc============cc=cc=c==1====================M
 -1e166j  M====================2=cc=ccc=c=c=cc===c===c=c==ccc=c==cc=c=c2====================M
 -8e181j  M====================1ccccccccccccccccccccccccccccccccccccccc1====================M
 -5e197j  M====================4ccccccccccccccccccccccccccccccccccccccc4====================M
 -3e213j  M====================3ccccccccccccccccccccccccccccccccccccccc3====================M
 -2e229j  M====================2ccccccccccccccccccccccccccccccccccccccc2====================M
 -1e245j  M====================2=======c===============================2====================M
 -8e260j  M====================2ccccccccccccccccccccccccccccccccccccccc2====================M
 -5e276j  M====================3===c===================================3====================M
 -3e292j  M====================1c==ccc=ccccc===c=c===cc==c=cccc===cccc=1====================M
    minj  M====================1c=c===cc=c==cc=c=======c=cc==c=ccc==c=c1====================M
   -infj  M~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~M

real line:===================================================================================
          ^      ^      ^     ^       ^       ^    ^    ^       ^       ^     ^      ^      ^
       -inf -3e213 -9e102  -2e8 -7e-119 -3e-245    0    3e-245  7e-119  2e8   9e102  3e213  +inf

  CUDA
  jax.numpy.tanh on complex128 plane
  vs
  CPU
  mpmath.tanh on complex128 plane

Statistics:
    match rate: 95.3%
    inaccuracies rate: 2.4%
    mismatch rate: 2.4%

Versions:
    mpmath 1.3.0
    jax 0.4.24.dev20240130+66308c30a

Legend:
        = : values are equal (diff == 0)
        c : values are close (diff < eps * norm)
    [1-F] : values are close (diff < eps * norm * 10 ** n, n < resolution)
        x : values magnitudes are close (diff is approx. eps * norm * 10 ** resolution)
        X : values are different (diff >= eps * norm * 10 ** resolution or one is non-finite)
        ~ : values are non-finite and of the same kind (-inf, inf, or nan)
        I : one value is finite but other inf
        N : one value is not nan but other is nan
        M : one value is nan but other is not nan

Samples with code 2:
        (2.539695490683624e-08-3.7563705781985466e+55j) ->              (1.434917340608879e-07+2.156376177045717j)              (1.434917340608875e-07+2.156376177045711j)
        (2.539695490683624e-08-8.958978968711629e+102j) ->             (2.7554449507378592e-08-0.291463405409385j)            (2.755444950737858e-08-0.29146340540938476j)
       (2.539695490683624e-08-1.3250897649822135e+166j) ->             (2.3126262061459424e-07+2.847089610718094j)            (2.3126262061459326e-07+2.8470896107180814j)
       (2.539695490683624e-08-1.2154267139513415e+245j) ->           (2.8648773966995955e-08-0.35782638606001427j)             (2.8648773966995938e-08-0.357826386060014j)
       (2.539695490683624e-08+2.8988040827220484e+292j) ->            (2.7734204252285074e-07+3.1496487481631283j)             (2.773420425228493e-07+3.1496487481631124j)
       (2.539695490683624e-08+1.2154267139513415e+245j) ->           (2.8648773966995955e-08+0.35782638606001427j)             (2.8648773966995938e-08+0.357826386060014j)
       (2.539695490683624e-08+3.1603514852952437e+213j) ->              (6.516846987702393e-08+1.251397385415743j)             (6.516846987702384e-08+1.2513973854157414j)
       (2.539695490683624e-08+1.3250897649820401e+166j) ->            (3.4401039626493196e-08-0.5954276008933216j)             (3.440103962649318e-08-0.5954276008933211j)
        (2.539695490683624e-08+8.958978968710456e+102j) ->             (5.837187092981278e-08-1.1394650926503118j)             (5.837187092981271e-08-1.1394650926503105j)
         (2.539695490683624e-08+6.057197503361904e+39j) ->             (2.929443244568439e-08-0.3917427670261548j)            (2.9294432445684374e-08-0.3917427670261545j)
      (-2.5396954906839566e-08-3.7563705781985466e+55j) ->            (-1.4349173406090668e-07+2.156376177045717j)             (-1.434917340609063e-07+2.156376177045711j)
      (-2.5396954906839566e-08-8.958978968711629e+102j) ->            (-2.7554449507382202e-08-0.291463405409385j)          (-2.7554449507382186e-08-0.29146340540938476j)
     (-2.5396954906839566e-08-1.3250897649822135e+166j) ->            (-2.3126262061462452e-07+2.847089610718094j)           (-2.3126262061462354e-07+2.8470896107180814j)
     (-2.5396954906839566e-08-1.2154267139513415e+245j) ->          (-2.8648773966999707e-08-0.35782638606001427j)             (-2.864877396699969e-08-0.357826386060014j)
     (-2.5396954906839566e-08+2.8988040827220484e+292j) ->           (-2.7734204252288706e-07+3.1496487481631283j)           (-2.7734204252288563e-07+3.1496487481631124j)
     (-2.5396954906839566e-08+1.2154267139513415e+245j) ->          (-2.8648773966999707e-08+0.35782638606001427j)             (-2.864877396699969e-08+0.357826386060014j)
     (-2.5396954906839566e-08+3.1603514852952437e+213j) ->             (-6.516846987703246e-08+1.251397385415743j)            (-6.516846987703238e-08+1.2513973854157414j)
     (-2.5396954906839566e-08+1.3250897649820401e+166j) ->             (-3.44010396264977e-08-0.5954276008933216j)            (-3.440103962649768e-08-0.5954276008933211j)
      (-2.5396954906839566e-08+8.958978968710456e+102j) ->           (-5.8371870929820425e-08-1.1394650926503118j)            (-5.837187092982035e-08-1.1394650926503105j)
       (-2.5396954906839566e-08+6.057197503361904e+39j) ->           (-2.9294432445688226e-08-0.3917427670261548j)           (-2.9294432445688212e-08-0.3917427670261545j)
Samples with code 3:
            (2.539695490683624e-08-157499196.83966908j) ->            (4.1138362227174244e-07-3.8984801558040876j)            (4.1138362227173927e-07-3.8984801558040574j)
        (2.539695490683624e-08-3.445497255278356e+134j) ->             (1.4197892534831095e-06-7.409717725817582j)              (1.4197892534830712e-06-7.40971772581738j)
       (2.539695490683624e-08-3.1603514852956575e+213j) ->              (7.782328195964351e-07+5.444516600229743j)              (7.782328195964238e-07+5.444516600229663j)
        (2.539695490683624e-08-4.674360126903885e+276j) ->             (4.182558709363404e-07-3.9330320284085443j)            (4.1825587093633705e-07-3.9330320284085127j)
        (2.539695490683624e-08+1.4446472708764676e+87j) ->             (1.2671585729551001e-06+6.992432650889957j)             (1.2671585729550697e-06+6.992432650889789j)
            (2.539695490683624e-08+157499196.83964846j) ->            (4.1131748062510346e-07+3.8981461249089215j)              (4.113174806251003e-07+3.898146124908891j)
          (-2.5396954906839566e-08-157499196.83966908j) ->           (-4.1138362227179633e-07-3.8984801558040876j)           (-4.1138362227179316e-07-3.8984801558040574j)
      (-2.5396954906839566e-08-3.445497255278356e+134j) ->            (-1.4197892534832952e-06-7.409717725817582j)              (-1.419789253483257e-06-7.40971772581738j)
     (-2.5396954906839566e-08-3.1603514852956575e+213j) ->              (-7.78232819596537e-07+5.444516600229743j)             (-7.782328195965257e-07+5.444516600229663j)
      (-2.5396954906839566e-08-4.674360126903885e+276j) ->            (-4.182558709363952e-07-3.9330320284085443j)           (-4.1825587093639184e-07-3.9330320284085127j)
      (-2.5396954906839566e-08+1.4446472708764676e+87j) ->             (-1.267158572955266e-06+6.992432650889957j)            (-1.2671585729552357e-06+6.992432650889789j)
          (-2.5396954906839566e-08+157499196.83964846j) ->           (-4.1131748062515735e-07+3.8981461249089215j)             (-4.113174806251541e-07+3.898146124908891j)
Samples with code 4:
       (2.539695490683624e-08-5.0961087911783856e+197j) ->            (1.1144560189024439e-05+20.924024940857908j)             (1.1144560189022076e-05+20.92402494085347j)
       (2.539695490683624e-08+1.9598917369853978e+229j) ->            (1.0427356226441018e-05+20.237960808993787j)             (1.0427356226438947e-05+20.23796080898977j)
       (2.539695490683624e-08+3.4454972552776795e+134j) ->             (6.0877443484880465e-06+15.45003920263687j)             (6.087744348487341e-06+15.450039202635079j)
     (-2.5396954906839566e-08-5.0961087911783856e+197j) ->           (-1.1144560189025897e-05+20.924024940857908j)            (-1.1144560189023536e-05+20.92402494085347j)
     (-2.5396954906839566e-08+1.9598917369853978e+229j) ->           (-1.0427356226442384e-05+20.237960808993787j)            (-1.0427356226440312e-05+20.23796080898977j)
     (-2.5396954906839566e-08+3.4454972552776795e+134j) ->             (-6.087744348488844e-06+15.45003920263687j)            (-6.087744348488138e-06+15.450039202635079j)
Samples with code M:
                              (inf-157499196.83966908j) ->                                                  (1-0j)                                                (nan+0j)
                              (inf+157499196.83964846j) ->                                                  (1+0j)                                                (nan+0j)
                             (-inf-157499196.83966908j) ->                                                 (-1-0j)                                                (nan+0j)
                             (-inf+157499196.83964846j) ->                                                 (-1+0j)                                                (nan+0j)
Legend:
    <input> -> <value> <reference value>