
   +infj  NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
    maxj  NX~~~~~~~~~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~XN
   4e36j  N~X~~~~~~~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~N
   4e34j  N~~X~~~~~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~N
   4e32j  N~~~X~~~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~N
   5e30j  NX~~~X~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~N
   5e28j  NXX~~~X~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~~N
   6e26j  NXXX~~~X~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~~~N
   6e24j  NXXXX~~~X~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~~~~N
   7e22j  NXXXXX~~~X~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~~~~~N
   8e20j  NXXXXXX~~~X~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~X~~~~~~~~~N
   8e18j  NXXXXXXX~~~2222222222222222222222222222222222222222222222222222222222222~~~~~~~~~~N
   9e16j  NXXXXXXXX~X2222222222222222222222222222222222222222222222222222222222222X~~~~~~~~~N
   1e15j  NXXXXXXXXXX2222222222222222222222222222222222222222222222222222222222222XX~~~~~~~~N
   1e13j  NXXXXXXXXXX2221c22222222222222222222222222222222222222222222222222211222XXX~~~~~~~N
   1e11j  NXXXXXXXXXX222122222222222222222222222222222222222222222222222222222=222XXXX~~~~~~N
    1e9j  NXXXXXXXXXX2222222222222222222222222222222222222222222222222222222222222XXXXX~~~~~N
    1e7j  NXXXXXXXXXX2222222222222222222222222222222222222222222222222222222222222XXXXXX~~~~N
    2e5j  NXXXXXXXXXX2222222cc22222222222222222222222222222222222222222221c2222222XXXXXXX~~~N
    2e3j  NXXXXXXXXXX22222221211cc1111111111111111111111111111111111111112c2222222XXXXXXXX~~N
    2e1j  NXXXXXXXXXX2222222221c11111111111111111111111111111111111111111122222222XXXXXXXXX~N
   2e-1j  NXXXXXXXXXX2222222211cc11c111111111111111111111111111111111c1cc122222222XXXXXXXXXXN
   2e-3j  NXXXXXXXXXX22222222c11c1222222222222222222222222222222222221cc1c22222222XXXXXXXXXXN
   3e-5j  NXXXXXXXXXX22222222111121c1c11111111111111111111111111111c221c1c22222222XXXXXXXXXXN
   3e-7j  NXXXXXXXXXX2222222211c222222222222222222222222222222222222212c1c22222222XXXXXXXXXXN
   3e-9j  NXXXXXXXXXX222222221112122222222222222222222222222222222222c2c1c22222222XXXXXXXXXXN
  3e-11j  NXXXXXXXXXX222222221112c22222222222222222222222222222222222c2c1c22222222XXXXXXXXXXN
  4e-13j  NXXXXXXXXXX222222221112122222111111111111111111111111122222c2c1c22222222XXXXXXXXXXN
  4e-15j  NXXXXXXXXXX222222221112122222222222222222222222222222222222c2c1c22222222XXXXXXXXXXN
  4e-17j  NXXXXXXXXXX22222222111212221222222222222222222222222222c222c2c1c22222222XXXXXXXXXXN
  5e-19j  NXXXXXXXXXX222222221112122212222222222222222222222222221222c2c1c22222222XXXXXXXXXXN
  5e-21j  NXXXXXXXXXX222222221112122212223===================32221222c2c1c22222222XXXXXXXXXXN
  6e-23j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
  6e-25j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
  7e-27j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
  7e-29j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
  8e-31j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
  9e-33j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
  1e-34j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
  1e-36j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
   tinyj  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
      0j  ~XXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222~~~~~~~~~~~
  -tinyj  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -1e-36j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -1e-34j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -9e-33j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -8e-31j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -7e-29j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -7e-27j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -6e-25j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -6e-23j  NXXXXXXXXXX22222222111212221222=====================2221222c2c1c22222222XXXXXXXXXXN
 -5e-21j  NXXXXXXXXXX222222221112122212223===================32221222c2c1c22222222XXXXXXXXXXN
 -5e-19j  NXXXXXXXXXX222222221112122212222222222222222222222222221222c2c1c22222222XXXXXXXXXXN
 -4e-17j  NXXXXXXXXXX22222222111212221222222222222222222222222222c222c2c1c22222222XXXXXXXXXXN
 -4e-15j  NXXXXXXXXXX222222221112122222222222222222222222222222222222c2c1c22222222XXXXXXXXXXN
 -4e-13j  NXXXXXXXXXX222222221112122222111111111111111111111111122222c2c1c22222222XXXXXXXXXXN
 -3e-11j  NXXXXXXXXXX222222221112c22222222222222222222222222222222222c2c1c22222222XXXXXXXXXXN
  -3e-9j  NXXXXXXXXXX222222221112122222222222222222222222222222222222c2c1c22222222XXXXXXXXXXN
  -3e-7j  NXXXXXXXXXX2222222211c222222222222222222222222222222222222212c1c22222222XXXXXXXXXXN
  -3e-5j  NXXXXXXXXXX22222222111121c1c11111111111111111111111111111c221c1c22222222XXXXXXXXXXN
  -2e-3j  NXXXXXXXXXX22222222c11c1222222222222222222222222222222222221cc1c22222222XXXXXXXXXXN
  -2e-1j  NXXXXXXXXXX2222222211cc11c111111111111111111111111111111111c1cc122222222XXXXXXXXXXN
   -2e1j  NXXXXXXXXXX2222222221c11111111111111111111111111111111111111111122222222XXXXXXXXX~N
   -2e3j  NXXXXXXXXXX22222221211cc1111111111111111111111111111111111111112c2222222XXXXXXXX~~N
   -2e5j  NXXXXXXXXXX2222222cc22222222222222222222222222222222222222222221c2222222XXXXXXX~~~N
   -1e7j  NXXXXXXXXXX2222222222222222222222222222222222222222222222222222222222222XXXXXX~~~~N
   -1e9j  NXXXXXXXXXX2222222222222222222222222222222222222222222222222222222222222XXXXX~~~~~N
  -1e11j  NXXXXXXXXXX222122222222222222222222222222222222222222222222222222222=222XXXX~~~~~~N
  -1e13j  NXXXXXXXXXX2221c22222222222222222222222222222222222222222222222222211222XXX~~~~~~~N
  -1e15j  NXXXXXXXXXX2222222222222222222222222222222222222222222222222222222222222XX~~~~~~~~N
  -9e16j  NXXXXXXXX~X2222222222222222222222222222222222222222222222222222222222222X~~~~~~~~~N
  -8e18j  NXXXXXXX~~~2222222222222222222222222222222222222222222222222222222222222~~~~~~~~~~N
  -8e20j  NXXXXXX~~~X~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~X~~~~~~~~~N
  -7e22j  NXXXXX~~~X~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~~~~~N
  -6e24j  NXXXX~~~X~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~~~~N
  -6e26j  NXXX~~~X~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~~~N
  -5e28j  NXX~~~X~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~~N
  -5e30j  NX~~~X~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~~N
  -4e32j  N~~~X~~~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~~N
  -4e34j  N~~X~~~~~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~~N
  -4e36j  N~X~~~~~~~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~X~N
    minj  NX~~~~~~~~~~~~~~~~~~~XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX~~~XN
   -infj  NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN

real line:~~~~~~~~~~~=============================================================~~~~~~~~~~~
          ^     ^     ^    ^     ^      ^      ^   ^   ^      ^      ^     ^    ^     ^     ^
       -inf -5e28 -9e16 -1e7 -3e-5 -5e-19 -9e-33   0   9e-33  5e-19  3e-5  1e7  9e16  5e28  +inf

  CUDA
  torch.square on complex64 plane
  vs
  CPU
  numpy.square on complex128 plane

Statistics:
    match rate: 16.3%
    inaccuracies rate: 45.4%
    mismatch rate: 38.4%

Versions:
    numpy 1.26.3
    torch 2.1.2

Legend:
        = : values are equal (diff == 0)
        c : values are close (diff < eps * norm)
    [1-F] : values are close (diff < eps * norm * 10 ** n, n < resolution)
        x : values magnitudes are close (diff is approx. eps * norm * 10 ** resolution)
        X : values are different (diff >= eps * norm * 10 ** resolution or one is non-finite)
        ~ : values are non-finite and of the same kind (-inf, inf, or nan)
        I : one value is finite but other inf
        N : one value is not nan but other is nan
        M : one value is nan but other is not nan

Samples with code X:
        (5.358817286521974e+28-3.9524895129820076e-15j) ->                                  (inf-426551959093248j)                                  (inf-423613396156416j)
        (3.0097755399083326e-09-4.893543125372159e+30j) ->                                             (-inf+infj)                          (-inf-2.9456932773522454e+22j)
         (5.358817286521974e+28-5.358817286521974e+28j) ->                                             (-inf-infj)                                                   -infj
        (3.0097755399083326e-09+4.893543125372159e+30j) ->                                             (-inf-infj)                          (-inf+2.9456932773522454e+22j)
         (4.893543125372159e+30+4.893543125372159e+30j) ->                                             (-inf+infj)                                                    infj
        (5.358817286521974e+28+3.9524895129820076e-15j) ->                                  (inf+426551959093248j)                                  (inf+423613396156416j)
       (-4.893543125372159e+30-3.0097755399083326e-09j) ->                                              (inf-infj)                           (inf+2.9456932773522454e+22j)
        (-5.358817286521974e+28-5.358817286521974e+28j) ->                                              (inf+infj)                                                    infj
       (-3.9524895129820076e-15-5.358817286521974e+28j) ->                                             (-inf+infj)                                 (-inf+423613396156416j)
        (-4.893543125372159e+30+4.893543125372159e+30j) ->                                              (inf-infj)                                                   -infj
       (-3.9524895129820076e-15+5.358817286521974e+28j) ->                                             (-inf-infj)                                 (-inf-423613396156416j)
       (-4.893543125372159e+30+3.0097755399083326e-09j) ->                                              (inf+infj)                           (inf-2.9456932773522454e+22j)
                            (-4.893543125372159e+30+0j) ->                                              (inf+infj)                                                (inf-0j)
                                 4.893543125372159e+30j ->                                             (-inf-infj)                                               (-inf+0j)
                                -5.358817286521974e+28j ->                                             (-inf+infj)                                               (-inf-0j)
Samples with code N:
                            (inf-7.70639220474525e+20j) ->                                              (inf+nanj)                                              (inf-infj)
                            (7.70639220474525e+20+infj) ->                                              (inf+nanj)                                             (-inf+infj)
                           (-inf-7.70639220474525e+20j) ->                                              (inf+nanj)                                              (inf+infj)
                           (-7.70639220474525e+20+infj) ->                                              (inf+nanj)                                             (-inf-infj)
                                                   infj ->                                              (inf+nanj)                                             (-inf+nanj)
                                                  -infj ->                                              (inf+nanj)                                             (-inf+nanj)
Samples with code 2:
         (4.739819356183978e-19-4.739819356183978e-19j) ->        (-1.961817850054744e-44-4.4931933488304326e-37j)                                 -4.493177654287632e-37j
                   (159373.234375-0.20929168164730072j) ->                            (25399818240-66710.9609375j)                             (25399828480-66710.984375j)
                   (0.20929168164730072+159373.234375j) ->                           (-25399818240+64393.1484375j)                            (-25399828480+66710.984375j)
         (4.739819356183978e-19+4.739819356183978e-19j) ->        (-1.961817850054744e-44+4.4931933488304326e-37j)                                  4.493177654287632e-37j
               (-1745.2630615234375-19.11201286315918j) ->                                (3045579+66710.3046875j)                                (3045578+66710.9765625j)
        (-4.739819356183978e-19-4.739819356183978e-19j) ->         (5.605193857299268e-45+4.4931933488304326e-37j)                                  4.493177654287632e-37j
               (-1745.2630615234375+19.11201286315918j) ->                                (3045579-66710.3046875j)                                (3045578-66710.9765625j)
      (-4.3282890605049666e-17+4.3282890605049666e-17j) ->          (4.468040153499679e-41-3.746829101186516e-33j)                                -3.7468173462430075e-33j
                                   (-11082385063936+0j) ->         (1.2281946428379836e+26+2.147443625776749e+19j)                             (1.2281926136961355e+26-0j)
                            (-0.0022919096518307924+0j) ->          (5.252847586234566e-06+9.184370928713714e-13j)                               (5.25284985997132e-06-0j)
                           (-3.0097755399083326e-09+0j) ->         (9.058739438198924e-18+1.5838803489214709e-24j)                              (9.058748537185662e-18-0j)
                           (-4.3282890605049666e-17+0j) ->         (1.873402979320742e-33+3.2755631863285464e-40j)                             (1.8734086731215037e-33-0j)
                            (4.3282890605049666e-17+0j) ->                              (1.873402979320742e-33+0j)                             (1.8734086731215037e-33+0j)
                            (3.0097755399083326e-09+0j) ->                              (9.058739438198924e-18+0j)                              (9.058748537185662e-18+0j)
                             (0.0022919096518307924+0j) ->                              (5.252847586234566e-06+0j)                               (5.25284985997132e-06+0j)
                                      (121360891904+0j) ->                             (1.4728441616963276e+22+0j)                             (1.4728466386761227e+22+0j)
                                        11082385063936j ->       (-1.2281946428379836e+26-1.0737218128883745e+19j)                            (-1.2281926136961355e+26+0j)
                                 0.0022919096518307924j ->         (-5.252847586234566e-06-4.592185464356857e-13j)                              (-5.25284985997132e-06+0j)
                                3.0097755399083326e-09j ->        (-9.058739438198924e-18-7.9194017446073545e-25j)                             (-9.058748537185662e-18+0j)
                                4.3282890605049666e-17j ->        (-1.873402979320742e-33-1.6377815931642732e-40j)                            (-1.8734086731215037e-33+0j)
                               -4.3282890605049666e-17j ->        (-1.873402979320742e-33+1.6377815931642732e-40j)                            (-1.8734086731215037e-33-0j)
                               -3.0097755399083326e-09j ->        (-9.058739438198924e-18+7.9194017446073545e-25j)                             (-9.058748537185662e-18-0j)
                                -0.0022919096518307924j ->         (-5.252847586234566e-06+4.592185464356857e-13j)                              (-5.25284985997132e-06-0j)
                                         -121360891904j ->             (-1.4728441616963276e+22+1287601264787456j)                            (-1.4728466386761227e+22-0j)
Samples with code 3:
         (5.190477564413554e-21-5.190477564413554e-21j) ->                             (-0-5.388132725175354e-41j)                                 -5.388272855021787e-41j
         (5.190477564413554e-21+5.190477564413554e-21j) ->                             (-0+5.388132725175354e-41j)                                  5.388272855021787e-41j
        (-5.190477564413554e-21-5.190477564413554e-21j) ->                                  5.388132725175354e-41j                                  5.388272855021787e-41j
        (-5.190477564413554e-21+5.190477564413554e-21j) ->                                 -5.388132725175354e-41j                                 -5.388272855021787e-41j
Legend:
    <input> -> <value> <reference value>